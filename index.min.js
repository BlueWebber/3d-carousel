let attrs={overlay:"with-overlay",vertical:"vertical",itemsContainerElem:"items-container-element",perspective:"perspective",rotateNegative:"rotate-negative",rawMode:"raw"};class Cylinder extends HTMLElement{static observedAttributes=[attrs.overlay,attrs.vertical,attrs.itemsContainerElem,attrs.perspective,attrs.rotateNegative,];static sheet=new CSSStyleSheet;constructor(){super()}connectedCallback(){let e=this.hasAttribute(attrs.rawMode),t=this.hasAttribute(attrs.overlay),i=this.hasAttribute(attrs.vertical),r=this.getAttribute(attrs.itemsContainerElem)||"div",s=this.hasAttribute(attrs.rotateNegative)?-1:1,l=this.attachShadow({mode:"open"});l.adoptedStyleSheets=[Cylinder.sheet];let[n,a,o,h,c,p,]=[];e?(n=this.perspectiveContainer=this.querySelector("#perspective-container"),a=this.itemsContainer=this.querySelector("#items-container"),o=this.overlay=this.querySelector("#overlay"),h=this.items=a.querySelectorAll(":scope > :not(.ignore)"),c=this.ignoredElems=a.querySelectorAll(":scope > .ignore"),p=this.styleElems=this.querySelectorAll("style"),l.append(...this.querySelectorAll(":scope > *"))):(h=this.items=this.querySelectorAll(":scope > :not(style, link, .ignore)"),c=this.ignoredElems=this.querySelectorAll(".ignore"),p=this.styleElems=this.querySelectorAll("style"),(n=this.perspectiveContainer=document.createElement("div")).id="perspective-container",(a=this.itemsContainer=document.createElement(r)).id="items-container",(o=this.overlay=document.createElement("div")).id="overlay",a.append(...h,...c),this.replaceChildren(),n.appendChild(a),l.append(...p,o,n)),t||(o.style.display="none");let d=this.numSides=h.length,y=this.rotDeg=360/d,v=this.renderOut=()=>{let e=getComputedStyle(a.children[0]),r=parseInt(e[i?"height":"width"].replace(/[^0-9\.]+/g,"")),l=Math.tan(180*(d-2)/(2*d)*Math.PI/180)*(r/2);n.style.perspective=this.getAttribute(attrs.perspective)||l+4*r+"px",a.style.transformOrigin=`center center -${l}px`;for(let c=0;c<d;c++){let p=h[c];p.style.transformOrigin=`center center -${l}px`,p.style.transform=`rotate${i?"X":"Y"}(${s*c*y}deg)`}if(t){let v=window.innerWidth,m=0,g=window.innerHeight,u=0;h.forEach(e=>{let t=e.getBoundingClientRect();t.left<v&&(v=t.left),t.right>m&&(m=t.right),t.bottom>u&&(u=t.bottom),t.top<g&&(g=t.top)}),o.style.width=m-v+"px",o.style.height=u-g+"px"}},m=this.resizeObserver=new ResizeObserver(e=>{v()});m.observe(...h)}attributeChangedCallback(e,t,i){this.renderOut&&this.renderOut(),this.overlay&&e===attrs.overlay&&(this.overlay.style.display="block"===this.overlay.style.display?"none":"block")}disconnectedCallback(){this.resizeObserver.disconnect()}}Cylinder.sheet.replaceSync(`@layer cylinder-sheet{#items-container>*,#overlay{position:absolute}*{box-sizing:border-box}#items-container,#perspective-container,:host{height:100%;width:100%;display:flex;justify-content:center;align-items:center}:host{position:relative}#perspective-container{overflow:hidden}#items-container{position:relative;transform-style:preserve-3d}#overlay{z-index:1;max-height:100%;max-width:100%}}`);export default Cylinder;